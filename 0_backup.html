

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Plugins &mdash; PyFTLE3D 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=2709fde1"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            PyFTLE3D
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="1_requirements.html">Requirements and Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="2_theory.html">Theory of FTLE and LCS</a></li>
<li class="toctree-l1"><a class="reference internal" href="3_numerical.html">Numerical Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="4_input.html">Input Data Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="5_gui.html">Graphical User Interface (GUI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="6_inputdeck.html">Input Deck for Solver Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="7_command.html">Command-Line Mode (Commands)</a></li>
<li class="toctree-l1"><a class="reference internal" href="8_faqs.html">FAQs</a></li>
<li class="toctree-l1"><a class="reference internal" href="9_references.html">References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PyFTLE3D</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Plugins</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/0_backup.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <p>commercial <span class="xref std std-term">CFD</span> codes
is <code class="docutils literal notranslate"><span class="pre">Nelements</span> <span class="pre">*</span> <span class="pre">Np</span></code>,
the <span class="math notranslate nohighlight">\(x\)</span>-coordinates  a <span class="math notranslate nohighlight">\(\checkmark\)</span> in
in the
<span class="xref std std-ref">Creating a Mesh for Conjugate Heat Transfer</span> section</p>
<section id="plugins">
<h1>Plugins<a class="headerlink" href="#plugins" title="Link to this heading"></a></h1>
<section id="rans-k-tau-plugin">
<h2>RANS <span class="math notranslate nohighlight">\(k\)</span>-<span class="math notranslate nohighlight">\(\tau\)</span> Plugin<a class="headerlink" href="#rans-k-tau-plugin" title="Link to this heading"></a></h2>
<section id="add-the-closure-properties-calculation">
<h3>Add the Closure Properties Calculation<a class="headerlink" href="#add-the-closure-properties-calculation" title="Link to this heading"></a></h3>
<blockquote>
<div><ol class="arabic simple">
<li><p>Set the <code class="docutils literal notranslate"><span class="pre">udf.sEqnSource</span></code> function pointer to a function
local to the <code class="docutils literal notranslate"><span class="pre">.udf</span></code> file that actually computes the source terms</p></li>
<li><p>Add that source term function to the <code class="docutils literal notranslate"><span class="pre">.udf</span></code></p></li>
</ol>
</div></blockquote>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">user_q</span><span class="p">(</span><span class="n">nrs_t</span><span class="w"> </span><span class="o">*</span><span class="n">nrs</span><span class="p">,</span><span class="w"> </span><span class="n">dfloat</span><span class="w"> </span><span class="n">time</span><span class="p">,</span><span class="w"> </span><span class="n">occa</span><span class="o">::</span><span class="n">memory</span><span class="w"> </span><span class="n">o_S</span><span class="p">,</span><span class="w"> </span><span class="n">occa</span><span class="o">::</span><span class="n">memory</span><span class="w"> </span><span class="n">o_FS</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="n">RANSktau</span><span class="o">::</span><span class="n">updateSourceTerms</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>nekRS’s <span class="math notranslate nohighlight">\(k\)</span>-<span class="math notranslate nohighlight">\(\tau\)</span> implementation currently requires that
the laminar dynamic viscosity and the density are constant. Therefore, you
should not have any other material properties being set in this function
like there were in <span class="xref std std-ref">Setting Custom Properties</span>.</p>
</div>
<p id="setting-ics">Then, be sure to add this directory to your path:</p>
<blockquote>
<div><dl class="simple">
<dt>ALE</dt><dd><p>Arbitrary Lagrange Eulerian</p>
</dd>
</dl>
</div></blockquote>
<p>ed in <a class="reference internal" href="9_references.html#persson" id="id1"><span>[Persson]</span></a>
from <a class="reference external" href="https://github.com/Nek5000/nekRS">github</a>.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Variable Name</p></th>
<th class="head"><p>Size</p></th>
<th class="head"><p>Device?</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">comm</span></code></p></td>
<td><p>1</p></td>
<td></td>
<td><p>MPI communicator</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p>1</p></td>
<td></td>
<td><p>backend device</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dim</span></code></p></td>
<td><p>1</p></td>
<td></td>
<td><p>spatial dimension of mesh</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">elementInfo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Nelements</span></code></p></td>
<td></td>
<td><p>phase of element (0 = fluid, 1 = solid)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">EToB</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Nelements</span> <span class="pre">*</span> <span class="pre">Nfaces</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(\checkmark\)</span></p></td>
<td><p>boundary ID for each face</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">N</span></code></p></td>
<td><p>1</p></td>
<td></td>
<td><p>polynomial order for each dimension</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">NboundaryFaces</span></code></p></td>
<td><p>1</p></td>
<td></td>
<td><p><em>total</em> number of faces on a boundary (rank sum)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Nelements</span></code></p></td>
<td><p>1</p></td>
<td></td>
<td><p>number of elements</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Nfaces</span></code></p></td>
<td><p>1</p></td>
<td></td>
<td><p>number of faces per element</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Nfp</span></code></p></td>
<td><p>1</p></td>
<td></td>
<td><p>number of quadrature points per face</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Np</span></code></p></td>
<td><p>1</p></td>
<td></td>
<td><p>number of quadrature points per element</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">rank</span></code></p></td>
<td><p>1</p></td>
<td></td>
<td><p>parallel process rank</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">size</span></code></p></td>
<td><p>1</p></td>
<td></td>
<td><p>size of MPI communicator</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">vmapM</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Nelements</span> <span class="pre">*</span> <span class="pre">Nfaces</span> <span class="pre">*</span> <span class="pre">Nfp</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(\checkmark\)</span></p></td>
<td><p>quadrature point index for faces on boundaries</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">x</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Nelements</span> <span class="pre">*</span> <span class="pre">Np</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(\checkmark\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(x\)</span>-coordinates of quadrature points</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">y</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Nelements</span> <span class="pre">*</span> <span class="pre">Np</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(\checkmark\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(y\)</span>-coordinates of quadrature points</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">z</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Nelements</span> <span class="pre">*</span> <span class="pre">Np</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(\checkmark\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(z\)</span>-coordinates of quadrature points</p></td>
</tr>
</tbody>
</table>
<p>n <code class="xref std std-numref docutils literal notranslate"><span class="pre">fig-walls</span></code>.
Additionally <em>Nek5000</em> can handle conjugate heat transfer problems.</p>
<figure class="align-center" id="id2">
<span id="fig-walls"></span><img alt="domains" src="figs/walls.png" />
<figcaption>
<p><span class="caption-text">Computational domain showing respective fluid and solid subdomains, <span class="math notranslate nohighlight">\(\Omega_f\)</span> and
<span class="math notranslate nohighlight">\(\Omega_s\)</span>.  The shared boundaries are denoted <span class="math notranslate nohighlight">\(\partial\Omega_f=\partial\Omega_s\)</span>
and the solid boundary which is not shared by fluid is <span class="math notranslate nohighlight">\(\overline{\partial\Omega_s}\)</span>,
while the fluid boundary not shared by solid <span class="math notranslate nohighlight">\(\overline{\partial\Omega_f}\)</span>.</span><a class="headerlink" href="#id2" title="Link to this image"></a></p>
</figcaption>
</figure>
<p id="flow-vars">Flow Solution Fields and Simulation Settings
Flow Solution Fields and Simulation Settings
——————————————–
corresponding array <code class="docutils literal notranslate"><span class="pre">nrs-&gt;mue</span></code> member.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Variable Name</p></th>
<th class="head"><p>Size</p></th>
<th class="head"><p>Device?</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">cds</span></code></p></td>
<td><p>1</p></td>
<td></td>
<td><p>convection-diffusion solution object</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">cht</span></code></p></td>
<td><p>1</p></td>
<td></td>
<td><p>whether the problem contains conjugate heat transfer</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dim</span></code></p></td>
<td><p>1</p></td>
<td></td>
<td><p>spatial dimension of <code class="docutils literal notranslate"><span class="pre">nrs-&gt;mesh</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dt</span></code></p></td>
<td><p>3</p></td>
<td></td>
<td><p>time step for previous 3 time steps</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">fieldOffset</span></code></p></td>
<td><p>1</p></td>
<td></td>
<td><p>offset in flow solution arrays to access new component</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">FU</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">NVfields</span> <span class="pre">*</span> <span class="pre">nEXT</span> <span class="pre">*</span> <span class="pre">fieldOffset</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(\checkmark\)</span></p></td>
<td><p>source term for each momentum equation for each step in the time stencil</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">isOutputStep</span></code></p></td>
<td><p>1</p></td>
<td></td>
<td><p>if an output file is written on this time step</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">lastStep</span></code></p></td>
<td><p>1</p></td>
<td></td>
<td><p>if this time step is the last time step of the run</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">mesh</span></code></p></td>
<td><p>1</p></td>
<td></td>
<td><p>mesh used for the flow simulation</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">nEXT</span></code></p></td>
<td><p>1</p></td>
<td></td>
<td><p>number of time steps in the time derivative stencil</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">NiterU</span></code></p></td>
<td><p>1</p></td>
<td></td>
<td><p>number of iterations taken in last velocity solve</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">NiterP</span></code></p></td>
<td><p>1</p></td>
<td></td>
<td><p>number of iterations taken in last pressure solve</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Nlocal</span></code></p></td>
<td><p>1</p></td>
<td></td>
<td><p>number of quadrature points local to this process</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Nscalar</span></code></p></td>
<td><p>1</p></td>
<td></td>
<td><p>number of passive scalars to solve for</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">NTfields</span></code></p></td>
<td><p>1</p></td>
<td></td>
<td><p>number of flow-related fields to solve for (<span class="math notranslate nohighlight">\(\vec{V}\)</span> plus <span class="math notranslate nohighlight">\(T\)</span>)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">NVfields</span></code></p></td>
<td><p>1</p></td>
<td></td>
<td><p>number of velocity fields to solve for</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">o_mue</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">fieldOffset</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(\checkmark\)</span></p></td>
<td><p>total dynamic viscosity (laminar plus turbulent) for the momentum equation</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">options</span></code></p></td>
<td><p>1</p></td>
<td></td>
<td><p>object containing user settings from <code class="docutils literal notranslate"><span class="pre">.par</span></code> file</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">o_rho</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">fieldOffset</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(\checkmark\)</span></p></td>
<td><p>density for the momentum equation</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">P</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">fieldOffset</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(\checkmark\)</span></p></td>
<td><p>pressure solution for most recent time step</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">prop</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">*</span> <span class="pre">fieldOffset</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(\checkmark\)</span></p></td>
<td><p>total dynamic viscosity (laminar plus turbulent) and density (in this order) for the momentum equation</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">U</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">NVfields</span> <span class="pre">*</span> <span class="pre">fieldOffset</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(\checkmark\)</span></p></td>
<td><p>velocity solution for all components for most recent time step</p></td>
</tr>
</tbody>
</table>
<p>Passive Scalar Solution Fields and Simulation Settings</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Huanxia Wei.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
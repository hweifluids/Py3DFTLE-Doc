

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Just-in-time Compilation &mdash; PyFTLE3D 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=2709fde1"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            PyFTLE3D
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="1_requirements.html">Requirements and Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="2_theory.html">Theory of FTLE and LCS</a></li>
<li class="toctree-l1"><a class="reference internal" href="3_numerical.html">Numerical Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="4_input.html">Input Data Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="5_gui.html">Graphical User Interface (GUI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="6_inputdeck.html">Input Deck for Solver Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="7_command.html">Command-Line Mode (Commands)</a></li>
<li class="toctree-l1"><a class="reference internal" href="8_faqs.html">FAQs</a></li>
<li class="toctree-l1"><a class="reference internal" href="9_references.html">References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PyFTLE3D</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Just-in-time Compilation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/just_in_time_compilation.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="just-in-time-compilation">
<span id="id1"></span><h1>Just-in-time Compilation<a class="headerlink" href="#just-in-time-compilation" title="Link to this heading"></a></h1>
<p>nekRS uses just-in-time compilation to build the functions in the <code class="docutils literal notranslate"><span class="pre">.udf</span></code> and <code class="docutils literal notranslate"><span class="pre">.oudf</span></code>
case files, as well as for compiling certain fixed-size arrays based on the order of
the polynomial approximation or other problem settings.</p>
<p>For most cases, no special actions need to be taken by the user for this
process to work correctly. However, a high-level understanding of the just-in-time
compilation is useful to know what steps need to be taken to fully clear the cached
build files, as well as how to perform the pre-compilation separately from a full run
to obtain more accurate runtime measurements.</p>
<p>When nekRS performs just-in-time compilation, object files are created in the
<code class="docutils literal notranslate"><span class="pre">.cache</span></code> directory within the current case directory. To completely clear the
cached state of the case, simply delete the <code class="docutils literal notranslate"><span class="pre">.cache</span></code> directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>user$ rm -rf .cache/
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you experience strange behavior when running your case during the precompilation
step (such as failures to build in COMMON blocks or other parts of the code that you
are not touching in the <code class="docutils literal notranslate"><span class="pre">.udf</span></code> and <code class="docutils literal notranslate"><span class="pre">.oudf</span></code> files), try deleting the <code class="docutils literal notranslate"><span class="pre">.cache</span></code>
directory and trying again. It is not uncommon for the precompilation process to miss
the need to build new versions of object files if you are making frequent changes to
the nekRS source. This is also sometimes encountered if you are using multiple nekRS
versions in different projects (such as standalone nekRS or nekRS wrapped within
a multiphysics coupling application such as <span class="xref std std-term">ENRICO</span>), but don’t have your
environment completely self-consistent.</p>
</div>
<p>The precompilation process usually takes on the order of one minute. Depending on
the use case, it may be advantageous to force the precompilation separately from the run itself.
To precompile the case, use the <code class="docutils literal notranslate"><span class="pre">nrspre</span></code> script. See the
<span class="xref std std-ref">Scripts That Ship with nekRS</span> section for where to find this script.</p>
<p>As an example, to precompile a case with name <code class="docutils literal notranslate"><span class="pre">my_case</span></code> for a later run with less than
or equal to 4 GPUs, the <code class="docutils literal notranslate"><span class="pre">nrspre</span></code> script would be used as follows. After the precompilation,
run as normal with the <code class="docutils literal notranslate"><span class="pre">nrsmpi</span></code> script, which then skips the precompilation step since
the case has already been compiled.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>user$ nrspre my_case 4
user$ nrsmpi my_case 32
</pre></div>
</div>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Huanxia Wei.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>